TLS/HTTPS Security Analysis Report
===================================

Date: 2025
Author: Cryptography Lab 4

This report provides a comprehensive analysis of Transport Layer Security (TLS),
its handshake process, protection mechanisms against man-in-the-middle (MITM) attacks,
and its application in securing web communications via HTTPS.

================================================================================
1. TLS HANDSHAKE EXPLANATION
================================================================================

The TLS handshake is a multi-step process that establishes a secure communication
channel between a client (web browser) and a server (web server). The handshake
ensures both parties agree on encryption parameters and authenticate each other.

1.1 Handshake Phases
-------------------

Phase 1: TCP Connection Establishment
  - Client sends SYN packet
  - Server responds with SYN-ACK
  - Client sends ACK
  - TCP connection established on port 443 (HTTPS)

Phase 2: TLS Handshake Protocol

Step 1: Client Hello
  - Client initiates TLS connection
  - Sends to server:
    * Highest TLS version supported (e.g., TLS 1.2, TLS 1.3)
    * List of supported cipher suites (encryption algorithms)
    * Client random number (28 bytes)
    * Compression methods supported
    * Extensions:
      - Server Name Indication (SNI) - specifies target hostname
      - Supported elliptic curves
      - Signature algorithms
      - Application-Layer Protocol Negotiation (ALPN)

Step 2: Server Hello
  - Server responds with:
    * Selected TLS version (highest mutually supported)
    * Selected cipher suite from client's list
    * Server random number (28 bytes)
    * Session ID (for session resumption)
    * Compression method selected
    * Extensions (if applicable)

Step 3: Certificate Exchange
  - Server sends its digital certificate chain
  - Certificate contains:
    * Server's public key
    * Server's identity (domain name)
    * Issuer information (Certificate Authority)
    * Validity period
    * Digital signature from CA
  - May include intermediate certificates

Step 4: Server Key Exchange (if required)
  - For cipher suites using Ephemeral Diffie-Hellman (DHE/ECDHE)
  - Server sends:
    * Diffie-Hellman parameters
    * Server's DH public key
    * Signature of the parameters

Step 5: Certificate Request (optional)
  - Server may request client certificate for mutual authentication
  - Rarely used in web browsing (mostly in enterprise/B2B scenarios)

Step 6: Server Hello Done
  - Server indicates it has finished sending handshake messages
  - Client can now proceed with key exchange

Step 7: Client Key Exchange
  - Client generates a pre-master secret (46 bytes for TLS 1.2)
  - Encrypts pre-master secret with server's public key (from certificate)
  - Sends encrypted pre-master secret to server
  - Both parties can now derive the same master secret

Step 8: Change Cipher Spec (Client)
  - Client signals it will switch to encrypted communication
  - All subsequent messages will be encrypted

Step 9: Encrypted Handshake Message (Client)
  - Client sends first encrypted message
  - Contains hash of all handshake messages (verification)

Step 10: Change Cipher Spec (Server)
  - Server signals it will switch to encrypted communication

Step 11: Encrypted Handshake Message (Server)
  - Server sends first encrypted message
  - Contains hash of all handshake messages (verification)

Phase 3: Application Data
  - Both parties now communicate using:
    * Symmetric encryption (AES, ChaCha20, etc.)
    * Message Authentication Code (MAC) for integrity
    * Keys derived from master secret

1.2 Key Derivation
-----------------
From the pre-master secret, both parties derive:
  - Master secret (using PRF - Pseudo-Random Function)
  - Client write MAC key
  - Server write MAC key
  - Client write encryption key
  - Server write encryption key
  - Client write IV (Initialization Vector)
  - Server write IV

1.3 Cipher Suite Components
---------------------------
A cipher suite specifies:
  - Key Exchange Algorithm: RSA, DHE, ECDHE, etc.
  - Authentication Algorithm: RSA, ECDSA, etc.
  - Bulk Encryption Algorithm: AES-128, AES-256, ChaCha20, etc.
  - MAC Algorithm: SHA256, SHA384, Poly1305, etc.

Example: TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
  - Key Exchange: ECDHE (Elliptic Curve Diffie-Hellman Ephemeral)
  - Authentication: RSA
  - Encryption: AES-256 in GCM mode
  - MAC: SHA384 (integrated in GCM mode)

================================================================================
2. PROTECTION AGAINST MAN-IN-THE-MIDDLE (MITM) ATTACKS
================================================================================

TLS provides multiple layers of protection against MITM attacks, where an attacker
intercepts and potentially modifies communication between two parties.

2.1 Certificate-Based Authentication
-----------------------------------
Mechanism:
  - Server presents a digital certificate signed by a trusted Certificate Authority (CA)
  - Certificate binds the server's public key to its domain name
  - Client verifies:
    * Certificate is valid and not expired
    * Certificate is signed by a trusted CA
    * Domain name in certificate matches the website being accessed
    * Certificate chain is valid (root CA â†’ intermediate CA â†’ server certificate)

Protection:
  - An attacker cannot forge a valid certificate for a legitimate domain
  - Even if attacker intercepts traffic, they cannot present a valid certificate
    without compromising a CA's private key (extremely difficult)
  - Browser/OS maintains a trust store of root CA certificates

2.2 Public Key Cryptography
--------------------------
Mechanism:
  - Server's public key is embedded in the certificate
  - Client encrypts pre-master secret with server's public key
  - Only the server with the corresponding private key can decrypt it

Protection:
  - MITM cannot decrypt the pre-master secret without server's private key
  - Without the pre-master secret, attacker cannot derive session keys
  - Attacker cannot decrypt or modify application data

2.3 Perfect Forward Secrecy (PFS)
---------------------------------
Mechanism:
  - Modern TLS uses Ephemeral Diffie-Hellman (DHE/ECDHE)
  - Each session generates unique, temporary key exchange parameters
  - Session keys are derived from ephemeral values, not long-term keys

Protection:
  - Even if server's private key is compromised later, past sessions remain secure
  - Each session has unique keys that are discarded after use
  - Attacker cannot retroactively decrypt captured traffic

2.4 Message Authentication Codes (MAC)
--------------------------------------
Mechanism:
  - Every encrypted message includes a MAC (or uses authenticated encryption)
  - MAC is computed using a secret key known only to client and server
  - Receiver verifies MAC before accepting message

Protection:
  - Any modification to encrypted data will invalidate the MAC
  - Attacker cannot modify messages without detection
  - Ensures data integrity and authenticity

2.5 Handshake Verification
-------------------------
Mechanism:
  - Both parties send encrypted handshake messages containing:
    * Hash of all previous handshake messages
    * Verification that both parties computed the same keys

Protection:
  - Detects if handshake was tampered with
  - Ensures both parties have the same view of the handshake
  - Prevents downgrade attacks (forcing weaker TLS versions)

2.6 Certificate Pinning (Advanced)
---------------------------------
Mechanism:
  - Applications can "pin" expected certificates or public keys
  - Even if a valid CA-signed certificate is presented, if it doesn't match
    the pinned certificate, connection is rejected

Protection:
  - Additional layer against compromised CAs
  - Protects against attacks where CA is compromised
  - Used by many mobile apps and security-critical applications

2.7 HSTS (HTTP Strict Transport Security)
----------------------------------------
Mechanism:
  - Website sends HSTS header instructing browser to always use HTTPS
  - Browser remembers this for the domain
  - Prevents downgrade to HTTP

Protection:
  - Prevents SSL stripping attacks
  - Forces encrypted connection even if user types http://
  - Protects against protocol downgrade attacks

2.8 Why MITM Attacks Fail
------------------------
An attacker attempting MITM faces these obstacles:

1. Cannot obtain valid certificate:
   - Would need to compromise a trusted CA (extremely difficult)
   - Browser would show certificate warning if invalid certificate used

2. Cannot decrypt traffic:
   - Doesn't have server's private key
   - Cannot derive session keys without pre-master secret
   - Cannot read or modify application data

3. Cannot impersonate server:
   - Certificate validation would fail (wrong domain name)
   - Browser would show security warning

4. Cannot modify messages:
   - MAC verification would fail
   - Receiver would detect tampering

5. Perfect Forward Secrecy:
   - Even if long-term keys compromised, past sessions secure
   - Each session uses unique ephemeral keys

================================================================================
3. TLS APPLICATION IN WEBSITES (HTTPS)
================================================================================

3.1 What is HTTPS?
-----------------
HTTPS (HTTP Secure) = HTTP + TLS/SSL
  - HTTP (Hypertext Transfer Protocol) for web page delivery
  - TLS/SSL for encryption and security
  - Default port: 443 (vs. HTTP port 80)

3.2 How HTTPS Secures Online Communications
-------------------------------------------

A. End-to-End Encryption
   - All data between browser and server is encrypted
   - Includes:
     * URLs and query parameters
     * Form data (passwords, credit cards, personal information)
     * Cookies and session tokens
     * Web page content
     * HTTP headers
   - Even if traffic is intercepted, it appears as encrypted gibberish

B. Data Integrity
   - TLS ensures data is not modified in transit
   - MAC/authenticated encryption detects any tampering
   - Users can trust that received data matches what server sent

C. Server Authentication
   - Certificate proves server's identity
   - Users can verify they're connecting to the legitimate website
   - Prevents phishing and spoofing attacks

D. Privacy Protection
   - ISPs, network administrators, and attackers cannot see:
     * Which specific pages user visits (only domain)
     * Search queries
     * Form submissions
     * Personal information
   - Protects user privacy

3.3 Real-World HTTPS Flow
------------------------

Example: User visits https://www.example.com

1. User types URL or clicks link
2. Browser performs DNS lookup for www.example.com
3. Browser initiates TCP connection to server on port 443
4. TLS handshake begins:
   a. Browser sends Client Hello with supported ciphers
   b. Server responds with Server Hello and certificate
   c. Browser verifies certificate:
      - Checks if CA is trusted
      - Verifies domain name matches
      - Checks validity dates
      - Validates certificate chain
   d. Browser encrypts pre-master secret with server's public key
   e. Both parties derive session keys
   f. Encrypted communication begins
5. Browser sends encrypted HTTP request
6. Server responds with encrypted HTTP response (web page)
7. Browser decrypts and displays page
8. All subsequent requests/responses are encrypted

3.4 HTTPS Indicators
--------------------
Browsers provide visual indicators:

- Lock icon (ðŸ”’) in address bar
- "Secure" or "Not Secure" label
- Green address bar (for Extended Validation certificates)
- HTTPS in URL (vs. HTTP)
- Certificate details accessible via lock icon

3.5 Benefits for Different Stakeholders
---------------------------------------

For End Users:
  - Privacy: ISPs cannot see browsing activity
  - Security: Passwords and sensitive data protected
  - Trust: Confidence that website is legitimate
  - Protection: Safe online transactions

For Website Owners:
  - SEO: Google favors HTTPS sites in search rankings
  - Trust: Users more likely to engage with secure sites
  - Compliance: Meets data protection regulations
  - Performance: HTTP/2 requires HTTPS (faster loading)

For E-commerce:
  - PCI DSS compliance requirement
  - Protects customer payment information
  - Builds customer confidence
  - Prevents data breaches

3.6 Modern TLS Versions
----------------------

TLS 1.2 (Widely Used):
  - Introduced in 2008
  - Strong cipher suites
  - Supports Perfect Forward Secrecy
  - Still secure and widely deployed

TLS 1.3 (Latest):
  - Introduced in 2018
  - Faster handshake (1-RTT vs 2-RTT)
  - Removed insecure cipher suites
  - Mandatory Perfect Forward Secrecy
  - Improved security and performance

3.7 Certificate Types
--------------------

Domain Validated (DV):
  - Basic validation
  - Verifies domain ownership only
  - Fast and inexpensive
  - Most common type

Organization Validated (OV):
  - Validates organization identity
  - More trust indicators
  - Moderate cost

Extended Validation (EV):
  - Strictest validation
  - Validates legal entity
  - Green address bar in browsers
  - Highest trust level

3.8 Common TLS/HTTPS Issues
--------------------------

Certificate Errors:
  - Expired certificate
  - Self-signed certificate
  - Certificate for wrong domain
  - Untrusted CA
  - Browser shows warning

Mixed Content:
  - HTTPS page loads HTTP resources
  - Browsers block or warn about mixed content
  - All resources should use HTTPS

Weak Cipher Suites:
  - Older servers may support weak encryption
  - Modern browsers reject weak ciphers
  - Servers should disable weak cipher suites

================================================================================
4. PRACTICAL OBSERVATIONS FROM INSPECTION
================================================================================

4.1 Certificate Information (from OpenSSL inspection)
----------------------------------------------------
When inspecting a website (e.g., www.google.com):

Issuer:
  - Typically a well-known CA (e.g., Google Trust Services, DigiCert, Let's Encrypt)
  - May include intermediate CA in chain

Validity:
  - Usually valid for 90 days to 1 year
  - Modern practice: shorter validity periods (Let's Encrypt: 90 days)
  - Automatically renewed by many providers

Subject:
  - Contains domain name(s) the certificate is valid for
  - May include Subject Alternative Names (SAN) for multiple domains

Cipher Suite:
  - Modern sites typically use:
    * ECDHE for key exchange (Perfect Forward Secrecy)
    * AES-256-GCM or AES-128-GCM for encryption
    * SHA256 or SHA384 for hashing
  - Example: TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384

4.2 Handshake Observations (from Wireshark)
-------------------------------------------
- Handshake typically completes in 1-3 round trips
- TLS 1.3 reduces to 1 round trip (0-RTT in some cases)
- Certificate chain may include 2-3 certificates
- Server selects strongest mutually supported cipher suite
- Client and server random numbers ensure uniqueness

================================================================================
5. CONCLUSION
================================================================================

TLS/HTTPS is fundamental to modern web security, providing:

1. Confidentiality: Encryption protects data from eavesdroppers
2. Integrity: MAC ensures data is not tampered with
3. Authentication: Certificates verify server identity
4. Perfect Forward Secrecy: Past sessions remain secure

The combination of certificate-based authentication, public key cryptography,
Perfect Forward Secrecy, and message authentication creates a robust defense
against MITM attacks. The TLS handshake establishes these security properties
before any sensitive data is transmitted.

For website operators, implementing HTTPS is no longer optional but essential
for user trust, search engine ranking, and regulatory compliance. For users,
the lock icon and HTTPS indicator provide assurance that their communications
are protected.

The evolution from SSL to TLS 1.3 demonstrates continuous improvement in both
security and performance, ensuring that secure web communications remain
practical and effective against evolving threats.

================================================================================
END OF REPORT
================================================================================

